<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
 <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <title></title>
</head>

<body>
<div id="wrapper">

 <nav>
  <section>
    <h5>  ______  <span> מגדר </span>  ______  </h5>
    <ul>
      <li id="check_female">  נשים <span></span></li>
      <li id="check_male" > גברים <span></span></li>
      <li id="check_band" > מעורב <span></span></li>
    </ul> 
  </section>
  <section>
  <h5>  ______  <span> נושאים </span>  ______  </h5>
    <ul>
      <li id="check_female" > אהבה <span></span></li>
      <li id="check_male" > מלחמה <span></span></li>
      <li id="check_band"> משפחה <span></span></li>
      <li id="check_band"> אופטימיות <span></span></li>
      <li id="check_band"> מולדת <span></span></li>
      <li id="check_band"> ריקודים <span></span></li>
      <li id="check_band"> דת ואמונה <span></span></li>
      <li id="check_band"> כאב <span></span></li>
    </ul>
  </section>
  <section>
  <h5>  ______  <span> סגנון </span>  ______  </h5>
    <ul>
      <li id="check_rock"> רוק <span></span></li>
      <li id="check_pop"> פופ <span></span></li>
      <li id="check_mizrahi"> ים-תיכוני <span></span></li>
      <li id="check_israel"> זמר עברי <span></span></li>
    </ul>
  </section>
  <section>
    <ul>
      <li>בחר הכל <span></span></li>
    </ul>
  </section>
  <section id="text">
  <h3>מצעד הפזמונים השנתי</h3>
  <h6>עשרת הראשונים של כל הזמנים</h6>
  </section>
</nav>
<div id="container"></div>
<div class="clear"></div>

<svg version="1.2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="graph" aria-labelledby="title" role="img">
<g class="grid y-grid" id="yGrid">
 <line x1="90" x2="1290" y1="50" y2="50"></line>
</g>
    <g class="labels x-labels" id="timeLineYear">
      <text x="100" y="40">1969</text>
      <text x="1280" y="40">2016</text>
      <!--<text x="400" y="590" class="label-title">Year</text> -->
  </g>
</g>
</svg>
  
  <div id="footerData">
    <section class="common_word">
      <h6 id="commonWord"></h6>
    </section>
    <section class="common_hashtag">
      <h6 id="commonWord"></h6>
    </section>
    <section class="common_category">
      <h6 id="commonWord"></h6>
    </section>

    
  </div>


   <script>
    $('#top10Button').click(function () {  
         
         var checkboxes = document.getElementsByTagName('input');
           for (var i = 0; i < checkboxes.length; i++) {
               if (checkboxes[i].type == 'checkbox') {
                  checkboxes[i].checked = true;
               }
          }
      $('div[data-gender]').each(function() {
          this.style.display = 'block'; 
            }); 
        $('div[data-category]').each(function() {
          this.style.display = 'block'; 
            }); 
      
    });
    
    
    (function() {


      //url for get my data from web service
      var url = 'https://lab1616.herokuapp.com/lab16/getHomePageDetails';
      var jsonData;

     //AJAX for get my data from web service
     $.getJSON(url, function( data ) {

        jsonData = data;
        console.log(jsonData);
  
        var commonWord = {test:0};
        var ExitInArray = 0;

        $.each(jsonData, function(index,value) {
            
            var divContainer = document.createElement("div");
            var showDiv = document.createElement("div");
            showDiv.className= "showClass";
            divContainer.className = 'year_'+value.year;
            
            $.each(value.songs, function(index,value) {
              
              // console.log('songName '+value.songName);
              // console.log('wordsAmount '+value.wordsAmount);
              // console.log('position '+value.position);
              // console.log('commonWordInLyrics '+value.commonWordInLyrics);
              // //console.log('image '+value.image);
              // console.log('gender '+value.gender);
              // console.log('commonWordInLyrics '+value.commonWordInLyrics);
              // console.log('category '+value.category);
              
              //check common word in each object and insert him to map
              for (var key in commonWord) {
                 //console.log("key " + key + " has value " + commonWord[key]);
              if(key == value.commonWordInLyrics){
                ExitInArray = 1;
                commonWord[value.commonWordInLyrics] = commonWord[value.commonWordInLyrics] + 1;            
                }
              }
              if(ExitInArray == 0){
                commonWord[value.commonWordInLyrics] = 1;
              } 
              ExitInArray = 0;
                    
              var divImg = document.createElement("div");
              divImg.className += "divAlbum";
              divImg.setAttribute("gender",value.gender);
              divImg.setAttribute("position",value.position);
              divImg.setAttribute("songName",value.songName);
              divImg.setAttribute("category",value.category);
              divImg.setAttribute("artist",value.artist);
              
              var img = document.createElement('img');
              img.src = value.lyricsUrl;

              divImg.append(img);
              

              divContainer.append(divImg);  
              showDiv.append(divContainer);


            });
          
                $("#container").append(showDiv);

                
                //get the common word from map
                var word = Object.keys(commonWord).reduce(function(a, b){
                   return commonWord[a] > commonWord[b] ? a : b;
                });

                //console.log(word);
                $("#commonWord").html("מילה נפוצה: " + word);
          
         });

                //init the values of gender menu side with numbers  
                $("#check_female span").html($('div[gender ="זמרת"]').length);
                $("#check_male span").html($('div[gender ="זמר"]').length); 
                $("#check_band span").html($('div[gender ="להקה"]').length); 

                //init the valueדs of category menu side with numbers
                $("#check_rock span").html($('div[category="רוק"]').length); 
                $("#check_pop span").html($('div[category="פופ"]').length); 
                $("#check_mizrahi span").html($('div[category="מוזיקה מזרחית"]').length); 
                $("#check_israel span").html($('div[category="זמר עברי"]').length); 
                
      }); 


    })();

  //**Hanle Gender Event **//
  // function divLengthFun(){
  //   if ($('.year_1971 > div[show ="no"]').length == 7) {
  //     $(this).css("top", "20px");

  //   };
  // };
  function divLengthFun(){

  $('.showClass div:first-child').each(function() {

          if (($(this).children('div[show ="no"]').length == 0 || $(this).children('div[show ="no"]').length == 1)) {
      $(this).css("top", "0px");
      } 
      else if(($(this).children('div[show ="no"]').length == 2 || $(this).children('div[show ="no"]').length == 3)){
      $(this).css("top", "20px");
      console.log("this is" +this);
      } 
      else if(($(this).children('div[show ="no"]').length == 4 || $(this).children('div[show ="no"]').length == 5)){
      $(this).css("top", "40px");
      }
      else if(($(this).children('div[show ="no"]').length == 6 || $(this).children('div[show ="no"]').length == 7)){
      $(this).css("top", "60px");  
      } 
      else if(($(this).children('div[show ="no"]').length == 8 || $(this).children('div[show ="no"]').length == 9)){
      $(this).css("top", "80px");    
      }

      });
      }
      function clear(){
        $('.showClass div:first-child').each(function() {
          $(this).css("top", "0px");
        });
      }
              
  //if user chosing to show MALE img by clicking
  $(document).ready(function() {

    $('#check_male').on('click',function() {

        if($('#check_female').hasClass( "blueColor" ))  {

            $('#check_female').removeClass("blueColor");
            $('div[gender ="זמרת"]').slideToggle("fast");

        }
        else if($('#check_band').hasClass( "blueColor" )){
            $('#check_band').removeClass("blueColor");
            $('div[gender ="להקה"]').slideToggle("fast");
        }

        $('#check_male').addClass("blueColor");
        $('div[gender ="זמר"]').slideToggle("fast");


            // console.log("inside check_male function");
            // if($(this).hasClass( "blueColor" )){

            //     console.log("check_male have blueColor class");

            //     if($('#check_female').hasClass( "blueColor" )){

            //     }
            //     else{
            //        console.log("female not checked");
            //        $('div[gender ="זמרת"]').slideToggle("fast");
            //     }
            //     if($('#check_band').hasClass( "blueColor" )){

            //     }
            //     else{
            //        console.log("band not checked");
            //        $('div[gender ="להקה"]').slideToggle("fast");
            //     }
             
            // }

            // else{

            //     console.log("check_male not have blueColor class");
            //     //female and band is not checked
            //     if((!$('#check_female').hasClass( "blueColor" )) && (!$('#check_band').hasClass( "blueColor" ))){

            //         $('div[gender ="להקה"]').slideToggle("fast");
            //         $('div[gender ="זמרת"]').slideToggle("fast");
            //     }
            //     if(($('#check_female').hasClass( "blueColor" )) || ($('#check_band').hasClass( "blueColor" ))){
            //         console.log("only check_male or check_band have blueColor class");
            //         $('div[gender ="זמר"]').slideToggle("fast");
            //     }


            // }
    });
  });
  //if user chosing to show FEMALE img by clicking
    $('#check_female').on('click',function() {

      
    });
    //if user chosing to show BAND img by clicking
    $('#check_band').on('click',function() {
      clear();
          $('div[gender]').not('div[gender ="להקה"]').slideToggle("fast");
           $('div[gender]').not('div[gender ="להקה"]').attr("show","no");
            
         
    });
   //if user chosing to show POP img by clicking
    $('#check_pop').on('click',function() {
            $('div[category]').not('div[category="פופ"]').slideToggle("fast").attr("show","no");
           
    });
     //if user chosing to show ROCK img by clicking
    $('#check_rock').on('click',function() {
            $('div[category]').not('div[category="רוק"]').slideToggle("fast").attr("show","no");
            
    });
    //if user chosing to show ISRAELI img by clicking
    $('#check_israel').on('click',function() {
            $('div[category]').not('div[category="עברי"]').slideToggle("fast").attr("show","no");
            
    }); 
    //if user chosing to show MIZRAHI img by clicking
    $('#check_mizrahi').click(function() {
            $('div[category]').not('div[category="ים תיכוני"]').slideToggle("fast").attr("show","no");
            
    });

    // Count function:
    /*
    $('#check_female,check_male, #check_band, #check_pop, #check_rock, #check_israel, #check_mizrahi').on('click',function() {
          
          if ($('.divAlbum').attr('show') == 'no'){
            femaleLength=0;
            maleLength=0;
            bandLength=0;
            popLength=0;
            rockLength=0;
            hebrewLength=0;
            mizrahiLength=0; 
          }else{
          var femaleLength=  $('div[gender ="נקבה"]').length; 
          var maleLength=  $('div[gender ="זכר"]').length;
          var bandLength=  $('div[gender ="להקה"]').length;
          var popLength=  $('div[category="פופ"]').length;
          var rockLength=  $('div[category="רוק"]').length;
          var hebrewLength=  $('div[category="עברי"]').length;
          var mizrahiLength=  $('div[category="ים תיכוני"]').length;

          }
          $("#check_female span").html(femaleLength);
          $("#check_male span").html(maleLength); 
          $("#check_band span").html(bandLength); 
          $("#check_pop span").html(popLength); 
          $("#check_rock span").html(rockLength); 
          $("#check_israel span").html(hebrewLength);
          $("#check_mizrahi span").html(mizrahiLength); 
    }); 
    */

    //for list change color and circle in Click!
  $('li').click( function() {
    $(this).toggleClass("blueColor");
  });

// for opacity on click
 var click = 1;
  $(document).on("click",".divAlbum",function() {
    var value = $(this).attr('artist');
    console.log("in female" + value);
    $( "#songLyrics" ).toggle();
    if(click == 1){
      console.log("onclick = " + click);

      $('.divAlbum').each(function() {

      console.log($(this).attr("artist"));
      
      if($(this).attr("artist") == value){
        $(this).css( "opacity", "1");
        console.log(value);

      }
      else{
        $(this).css( "opacity", "0.1");
        console.log("not" + value);
      }
      click = 0;
       }); 
    } 
    else{
      console.log("onclick = " + click);
      $('.divAlbum').css( "opacity", "1");
      click = 1;
    }
    // for the lyrics:

  });
 

$(document).mousemove(function(e) {
    $('#mouse_move').offset({
        left: e.pageX
    });
        $('#cursor').offset({
        left: e.pageX,
        top: e.pageY
    });
});

  $(document).on("mouseover",".divAlbum",function() {
     var value1 = $(this).attr('position');
        var value2 = $(this).attr('artist');
            var value3 = $(this).attr('songName');
             $("#position").html("#"+value1+ " "); 
             $("#artistName").html(value2+", ");
             $("#songName").html(value3);
      $("#current_year").css("display","block");
  });
  $(document).on("mouseout",".divAlbum",function() {
      $("#current_year, #songLyrics").css("display","none");
  });

    </script>

<div id="mouse_move">
  <div id="current_year">
      <h6><span id="position"></span><span id="artistName"></span> <span id="songName"></span> </h6>
  </div>
  <div id="line"></div>
  <div id="cursor"></div>
  <div id="songLyrics">
  <p>
    אדם בונה ביתו בדם ויגע 
מלילו ויומו 
ובסופה עזה, ממש בן רגע 
הוא חרב, כן, חרב עולמו. 
<br><br>
עוד שנה ועוד שנה 
הזמן הוא גלגל ענק 
ומחר עוד יום שממרומיו 
נדאה למרחק. 
<br><br>
מעגל נפתח בכל שנה 
ומעגל נסלח בכל שנה 
ואם דבר לא השתנה 
מחר ודאי נצחק. 
מעלה כשזה טוב 
ולא נורא כשמטה, אם זה רע - 
תמיד יש עוד ברירה - 
הזמן הוא כמו גלגל ענק. 
<br><br>
אדם אוהב תמיד בתום ולהט 
ביומו ולילו 
פתאום כמו רוח פרא לא נודעת 
נעלם, נעלם חלומו. 
<br><br>
עוד שנה ועוד שנה...  
  </p>
</div>
</div>

<div id="line2"></div>

</div> <!--end of wrapper-->
</body>
</html>